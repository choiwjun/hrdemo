# TASKS (AI 개발 파트너용 프롬프트 설계서)

> **프로젝트명:** 팀메이트
> **버전:** v1.0
> **작성일:** 2025-01-28
> **목적:** AI 코딩 파트너가 즉시 개발을 시작할 수 있도록 구조화된 태스크 제공

---

## 마일스톤 개요

| 마일스톤 | 목표 | 예상 태스크 수 |
|----------|------|---------------|
| **M0** | 프로젝트 초기화 및 기술 스택 설정 | 6개 |
| **M1** | 핵심 UI 및 디자인 시스템 구축 | 7개 |
| **M2** | 인증 및 사용자 관리 | 7개 |
| **M3** | 핵심 기능 개발 (MVP - 통합 메일함) | 10개 |
| **M4** | 근태 및 캘린더 기능 (Phase 2) | 7개 |
| **M5** | 테스트 및 배포 | 4개 |

---

## M0: 프로젝트 초기화 및 기술 스택 설정

### [x] M0-1: Next.js 프로젝트 생성 및 기본 설정

**컨텍스트 및 목표:**
팀메이트 프로젝트의 기반이 되는 Next.js 프로젝트를 생성합니다. App Router를 사용하며, TypeScript와 Tailwind CSS를 기본으로 설정합니다.

**사용자 스토리:**
> 개발자로서, 표준화된 프로젝트 구조에서 개발을 시작하고 싶습니다.

**기술 명세:**
- Next.js 14+ (App Router)
- TypeScript 5+
- Tailwind CSS 3+
- ESLint + Prettier 설정
- 📄 참조: TRD > 2. 권장 기술 스택 > 2.1 프론트엔드
- 📄 참조: TRD > 7. 폴더 구조

**인수 조건:**
- [ ] `npx create-next-app@latest teammate --typescript --tailwind --app` 실행 완료
- [ ] ESLint, Prettier 설정 파일 생성
- [ ] `.env.example` 파일 생성 (TRD 8. 환경 변수 참조)
- [ ] `npm run dev` 실행 시 로컬 서버 정상 동작
- [ ] 기본 폴더 구조 생성 (components, hooks, stores, types, lib, mocks)

**자가 수정 지침:**
빌드 오류 발생 시, 에러 메시지를 확인하고 의존성 버전 호환성을 점검하세요. `package.json`의 의존성 버전을 최신 안정 버전으로 맞추세요.

---

### [x] M0-2: Supabase 프로젝트 연결 및 클라이언트 설정

**컨텍스트 및 목표:**
Supabase를 백엔드로 사용하기 위해 클라이언트를 설정합니다. 인증과 데이터베이스 연결을 위한 기본 설정을 완료합니다.

**사용자 스토리:**
> 개발자로서, Supabase와 안전하게 통신할 수 있는 클라이언트를 갖고 싶습니다.

**기술 명세:**
- `@supabase/supabase-js` 설치
- `@supabase/ssr` 설치 (SSR 지원)
- 클라이언트/서버 분리 설정
- 📄 참조: TRD > 2.2 백엔드
- 📄 참조: TRD > 8. 환경 변수

**인수 조건:**
- [ ] `npm install @supabase/supabase-js @supabase/ssr` 완료
- [ ] `lib/supabase/client.ts` 생성 (브라우저용)
- [ ] `lib/supabase/server.ts` 생성 (서버 컴포넌트용)
- [ ] 환경 변수 설정 (`NEXT_PUBLIC_SUPABASE_URL`, `NEXT_PUBLIC_SUPABASE_ANON_KEY`)
- [ ] Supabase 연결 테스트 성공

**자가 수정 지침:**
연결 오류 시, 환경 변수가 올바르게 설정되었는지 확인하세요. Supabase 대시보드의 API 설정에서 URL과 anon key를 다시 확인하세요.

---

### [x] M0-3: 상태 관리 라이브러리 설정 (Zustand)

**컨텍스트 및 목표:**
글로벌 상태 관리를 위해 Zustand를 설정합니다. 인증 상태와 메일 관련 상태를 관리할 스토어를 생성합니다.

**사용자 스토리:**
> 개발자로서, 컴포넌트 간 상태를 효율적으로 공유하고 싶습니다.

**기술 명세:**
- Zustand 4+
- TypeScript 타입 정의
- 📄 참조: TRD > 2.1 프론트엔드 > 상태관리

**인수 조건:**
- [ ] `npm install zustand` 완료
- [ ] `stores/authStore.ts` 생성 (사용자 인증 상태)
- [ ] `stores/mailStore.ts` 생성 (메일 관련 상태)
- [ ] 각 스토어에 TypeScript 타입 적용

**자가 수정 지침:**
타입 오류 발생 시, Zustand의 타입 정의 문서를 참조하여 제네릭을 올바르게 적용하세요.

---

### [x] M0-4: TanStack Query 설정

**컨텍스트 및 목표:**
서버 상태 관리를 위해 TanStack Query(react-query)를 설정합니다. API 호출의 캐싱, 동기화, 로딩 상태를 효율적으로 관리합니다.

**사용자 스토리:**
> 개발자로서, API 호출 결과를 캐싱하고 로딩/에러 상태를 일관되게 처리하고 싶습니다.

**기술 명세:**
- `@tanstack/react-query` v5
- QueryClient Provider 설정
- 📄 참조: TRD > 2.1 프론트엔드 > 데이터 페칭

**인수 조건:**
- [ ] `npm install @tanstack/react-query` 완료
- [ ] `lib/queryClient.ts` 생성
- [ ] Provider 래퍼 컴포넌트 생성 (`providers/QueryProvider.tsx`)
- [ ] Root layout에 Provider 적용
- [ ] DevTools 설정 (개발 환경)

**자가 수정 지침:**
SSR 환경에서 hydration 오류 발생 시, QueryClient를 컴포넌트 내에서 생성하도록 수정하세요.

---

### [x] M0-5: 폼 유효성 검사 라이브러리 설정

**컨텍스트 및 목표:**
폼 관리와 유효성 검사를 위해 React Hook Form과 Zod를 설정합니다.

**사용자 스토리:**
> 개발자로서, 타입 안전한 폼 유효성 검사를 수행하고 싶습니다.

**기술 명세:**
- React Hook Form
- Zod (스키마 유효성 검사)
- `@hookform/resolvers` (Zod 연결)
- 📄 참조: TRD > 2.1 프론트엔드 > 폼 관리

**인수 조건:**
- [ ] `npm install react-hook-form zod @hookform/resolvers` 완료
- [ ] 로그인 폼 스키마 예제 생성 (`lib/validations/auth.ts`)
- [ ] 스키마 기반 TypeScript 타입 자동 추론 확인

**자가 수정 지침:**
스키마와 폼 데이터 타입 불일치 시, Zod 스키마의 `z.infer`를 사용하여 타입을 자동 추론하세요.

---

### [x] M0-6: Supabase 데이터베이스 스키마 생성

**컨텍스트 및 목표:**
Database Design 문서에 정의된 테이블들을 Supabase에 생성합니다. RLS(Row Level Security) 정책도 함께 설정합니다.

**사용자 스토리:**
> 개발자로서, 데이터를 저장하고 조회할 수 있는 데이터베이스 구조가 필요합니다.

**기술 명세:**
- 📄 참조: Database Design > 2. 테이블 상세 정의
- 📄 참조: Database Design > 5. 접근 제어 및 권한 모델
- 📄 참조: Database Design > 6. 프로필 자동 생성 트리거

**인수 조건:**
- [ ] `profiles` 테이블 생성 (사용자 프로필)
- [ ] `messages` 테이블 생성 (통합 메시지)
- [ ] `labels` 테이블 생성 (라벨)
- [ ] `message_labels` 테이블 생성 (메시지-라벨 연결)
- [ ] `attendances` 테이블 생성 (근태 기록)
- [ ] `events` 테이블 생성 (일정)
- [ ] `event_participants` 테이블 생성 (일정 참석자)
- [ ] 각 테이블에 RLS 정책 적용
- [ ] 프로필 자동 생성 트리거 설정
- [ ] 인덱스 생성 (Database Design 참조)

**자가 수정 지침:**
RLS 정책이 너무 제한적이면 데이터 조회가 안 될 수 있습니다. `auth.uid()`가 올바르게 작동하는지 확인하세요.

---

## M1: 핵심 UI 및 디자인 시스템 구축

### [x] M1-1: shadcn/ui 초기화 및 기본 컴포넌트 설치

**컨텍스트 및 목표:**
shadcn/ui를 초기화하고 자주 사용하는 기본 컴포넌트들을 설치합니다.

**사용자 스토리:**
> 개발자로서, 접근성이 보장된 UI 컴포넌트를 빠르게 사용하고 싶습니다.

**기술 명세:**
- shadcn/ui CLI 사용
- 📄 참조: Design System > 6. 컴포넌트 명세

**인수 조건:**
- [ ] `npx shadcn@latest init` 실행 완료
- [ ] Button, Input, Badge, Card, Dialog, Toast 컴포넌트 설치
- [ ] 컴포넌트 테스트 페이지에서 정상 렌더링 확인

**자가 수정 지침:**
컴포넌트 스타일 충돌 시, `tailwind.config.js`의 content 경로와 theme 확장을 확인하세요.

---

### [x] M1-2: 디자인 토큰 적용 (색상, 타이포그래피)

**컨텍스트 및 목표:**
Design System에 정의된 색상 팔레트와 타이포그래피를 Tailwind 설정에 적용합니다.

**사용자 스토리:**
> 디자이너로서, 일관된 디자인 토큰이 전체 앱에 적용되기를 원합니다.

**기술 명세:**
- 📄 참조: Design System > 2. 색상 팔레트
- 📄 참조: Design System > 3. 타이포그래피
- 📄 참조: Design System > 부록: Tailwind CSS 설정

**인수 조건:**
- [ ] `tailwind.config.js`에 커스텀 색상 추가 (primary, success, warning, error)
- [ ] Pretendard 폰트 적용
- [ ] 색상 대비비 4.5:1 이상 확인
- [ ] 테스트 페이지에서 색상/폰트 적용 확인

**자가 수정 지침:**
폰트 로딩 실패 시, `next/font` 또는 CDN 폰트 로딩 방식을 사용하세요.

---

### [x] M1-3: 레이아웃 컴포넌트 구현 (Header, Sidebar, Footer)

**컨텍스트 및 목표:**
앱의 기본 레이아웃을 구성하는 Header, Sidebar, Footer 컴포넌트를 구현합니다.

**사용자 스토리:**
> 사용자로서, 어느 페이지에서든 일관된 레이아웃을 경험하고 싶습니다.
> (PRD US-1.1 관련)

**기술 명세:**
- 📄 참조: Design System > 5.2 메일함 레이아웃
- 📄 참조: Design System > 4.2 레이아웃 간격
- 사이드바 너비: 240px
- 헤더 높이: 56px

**인수 조건:**
- [ ] `components/layout/Header.tsx` 구현 (로고, 검색, 프로필)
- [ ] `components/layout/Sidebar.tsx` 구현 (메뉴 네비게이션)
- [ ] `components/layout/Footer.tsx` 구현 (간단한 저작권 표시)
- [ ] 반응형 동작 확인 (모바일에서 사이드바 토글)
- [ ] 키보드 탐색 가능

**자가 수정 지침:**
모바일에서 사이드바가 콘텐츠를 가리면, 오버레이 방식으로 변경하세요.

---

### [x] M1-4: 메일 사이드바 컴포넌트 구현 (MailSidebar)

**컨텍스트 및 목표:**
통합 메일함의 좌측 네비게이션인 MailSidebar를 구현합니다. 받은편지함, 보낸편지함 등의 뷰와 라벨을 표시합니다.

**사용자 스토리:**
> 사용자로서, 메일함 종류(받은편지함, 보낸편지함 등)를 쉽게 전환하고 싶습니다.
> (PRD FEAT-1 관련)

**기술 명세:**
- 📄 참조: PRD > 5.1 MVP 범위 > 메시지 목록
- 📄 참조: User Flow > 3.1 메시지 목록 조회
- 뷰 목록: 받은편지함(mention/cc/bcc/all), 보낸편지함, 임시저장, 스팸, 휴지통
- 서비스 필터: 전체/Gmail/Slack

**인수 조건:**
- [ ] `components/mail/MailSidebar.tsx` 구현
- [ ] 뷰 전환 시 활성 상태 표시
- [ ] 서비스 필터 (Gmail/Slack/All) 구현
- [ ] 라벨 목록 표시 영역 (M3에서 데이터 연결)
- [ ] 새 메시지 작성 버튼

**자가 수정 지침:**
사이드바 아이템 클릭 영역이 너무 작으면, 최소 높이 40px를 적용하세요.

---

### [x] M1-5: 메일 리스트 컴포넌트 구현 (MailList, MailListItem)

**컨텍스트 및 목표:**
메시지 목록을 표시하는 MailList와 개별 아이템 MailListItem을 구현합니다.

**사용자 스토리:**
> 사용자로서, 메일/메시지 목록을 한눈에 보고 원하는 것을 선택하고 싶습니다.
> (PRD US-1.1, US-1.2)

**기술 명세:**
- 📄 참조: Design System > 6.8 메시지 리스트 아이템
- 📄 참조: Database Design > 2.3 messages
- 체크박스 다중 선택
- 읽음/안읽음 상태 시각적 구분
- 서비스 배지 (Gmail/Slack)

**인수 조건:**
- [ ] `components/mail/MailList.tsx` 구현 (리스트 컨테이너)
- [ ] `components/mail/MailListItem.tsx` 구현 (개별 아이템)
- [ ] 체크박스, 별표, 서비스 배지, 발신자, 시간, 제목, 미리보기 표시
- [ ] 미읽음 메시지 굵은 글씨 표시
- [ ] 호버 시 배경색 변경
- [ ] 스켈레톤 로딩 UI

**자가 수정 지침:**
리스트가 길어질 때 성능 문제가 발생하면, `react-virtual`을 사용한 가상화를 고려하세요.

---

### [x] M1-6: 메일 상세 컴포넌트 구현 (MailDetail)

**컨텍스트 및 목표:**
선택한 메시지의 상세 내용을 표시하는 MailDetail 컴포넌트를 구현합니다.

**사용자 스토리:**
> 사용자로서, 선택한 메시지의 전체 내용을 읽고 답장/전달/삭제를 하고 싶습니다.
> (PRD US-1.5, US-1.6)

**기술 명세:**
- 📄 참조: User Flow > 3.2 메시지 상세 조회
- 📄 참조: Database Design > 2.3 messages
- 스레드 형태 표시
- 액션 버튼: 답장, 전달, 삭제, 라벨

**인수 조건:**
- [ ] `components/mail/MailDetail.tsx` 구현
- [ ] 발신자, 수신자, 날짜, 제목, 본문 표시
- [ ] 첨부파일 목록 표시
- [ ] 답장, 전달, 삭제 버튼
- [ ] 라벨 적용/제거 버튼
- [ ] 빈 상태 (선택된 메시지 없음) UI

**자가 수정 지침:**
HTML 이메일 본문을 렌더링할 때 XSS 취약점에 주의하세요. `DOMPurify` 등을 사용하여 sanitize하세요.

---

### [x] M1-7: 메일 리스트 툴바 구현 (MailListToolbar)

**컨텍스트 및 목표:**
메시지 목록 상단에 표시되는 툴바를 구현합니다. 다중 선택 작업, 검색, 새로고침 등의 기능을 제공합니다.

**사용자 스토리:**
> 사용자로서, 여러 메시지를 선택하고 한 번에 처리하고 싶습니다.
> (PRD US-1.2 관련)

**기술 명세:**
- 📄 참조: PRD > 5.1.3 메시지 작업
- 📄 참조: Design System > 6.1 버튼
- 다중 선택 시 활성화되는 액션 버튼들

**인수 조건:**
- [ ] `components/mail/MailListToolbar.tsx` 구현
- [ ] 전체 선택/해제 체크박스
- [ ] 선택된 메시지 수 표시
- [ ] 일괄 읽음/안읽음 처리 버튼
- [ ] 일괄 삭제 버튼
- [ ] 일괄 라벨 적용 드롭다운
- [ ] 새로고침 버튼
- [ ] 선택 없을 때 버튼 비활성화 상태

**자가 수정 지침:**
다중 선택 상태는 부모 컴포넌트(MailList 또는 페이지)에서 관리하고, 툴바는 props로 받아 표시만 하세요.

---

## M2: 인증 및 사용자 관리

### [x] M2-1: 로그인 페이지 구현

**컨텍스트 및 목표:**
이메일/비밀번호 기반 로그인 페이지를 구현합니다.

**사용자 스토리:**
> 사용자로서, 이메일과 비밀번호로 로그인하고 싶습니다.

**기술 명세:**
- 📄 참조: User Flow > 2.2 로그인 흐름
- 📄 참조: Database Design > 2.1 users
- Supabase Auth 사용
- React Hook Form + Zod 유효성 검사

**인수 조건:**
- [ ] `app/(auth)/login/page.tsx` 구현
- [ ] 이메일, 비밀번호 입력 필드
- [ ] 폼 유효성 검사 (이메일 형식, 비밀번호 필수)
- [ ] 로그인 성공 시 대시보드로 리다이렉트
- [ ] 로그인 실패 시 오류 메시지 표시
- [ ] 회원가입 페이지 링크

**자가 수정 지침:**
Supabase 인증 오류 메시지를 사용자 친화적으로 변환하세요. 원본 에러를 그대로 노출하지 마세요.

---

### [x] M2-2: 회원가입 페이지 구현

**컨텍스트 및 목표:**
이메일/비밀번호 기반 회원가입 페이지를 구현합니다.

**사용자 스토리:**
> 사용자로서, 새 계정을 만들어 팀메이트를 사용하고 싶습니다.

**기술 명세:**
- 📄 참조: User Flow > 2.1 회원가입 흐름
- 📄 참조: Database Design > 2.2 profiles
- Supabase Auth signUp
- 프로필 자동 생성 트리거 (DB 측)

**인수 조건:**
- [ ] `app/(auth)/register/page.tsx` 구현
- [ ] 이메일, 비밀번호, 비밀번호 확인, 이름 입력 필드
- [ ] 비밀번호 규칙 검사 (최소 8자)
- [ ] 가입 성공 시 이메일 인증 안내 페이지로 이동
- [ ] 이미 존재하는 이메일 오류 처리

**자가 수정 지침:**
비밀번호 확인 필드가 일치하지 않을 때 실시간 피드백을 제공하세요.

---

### [x] M2-3: 인증 상태 관리 및 보호된 라우트 설정

**컨텍스트 및 목표:**
로그인 상태를 확인하고, 인증이 필요한 페이지를 보호합니다.

**사용자 스토리:**
> 사용자로서, 로그인하지 않으면 메일함에 접근할 수 없어야 합니다.

**기술 명세:**
- 📄 참조: TRD > 3.2 보안
- 📄 참조: TRD > 5. 접근 제어
- Supabase Auth 세션 확인
- 미들웨어 또는 Layout에서 체크

**인수 조건:**
- [ ] `middleware.ts` 구현 (보호된 경로 체크)
- [ ] 미인증 시 로그인 페이지로 리다이렉트
- [ ] 인증 상태를 Zustand 스토어에 저장
- [ ] 로그인 후 원래 접근하려던 페이지로 리다이렉트

**자가 수정 지침:**
미들웨어에서 무한 리다이렉트 루프가 발생하면, 로그인/회원가입 경로를 예외 처리하세요.

---

### [x] M2-4: 로그아웃 기능 구현

**컨텍스트 및 목표:**
로그아웃 버튼을 클릭하면 세션을 삭제하고 로그인 페이지로 이동합니다.

**사용자 스토리:**
> 사용자로서, 안전하게 로그아웃하고 싶습니다.

**기술 명세:**
- 📄 참조: User Flow > 2.3 로그아웃 흐름
- Supabase Auth signOut

**인수 조건:**
- [ ] 헤더에 로그아웃 버튼 추가
- [ ] 로그아웃 확인 다이얼로그
- [ ] 로그아웃 후 로그인 페이지로 리다이렉트
- [ ] Zustand 스토어 초기화

**자가 수정 지침:**
로그아웃 시 모든 클라이언트 상태(스토어, 쿼리 캐시)를 초기화하세요.

---

### [x] M2-5: 프로필 페이지 구현

**컨텍스트 및 목표:**
사용자가 자신의 프로필을 조회하고 수정할 수 있는 페이지를 구현합니다.

**사용자 스토리:**
> 사용자로서, 내 이름과 프로필 사진을 변경하고 싶습니다.

**기술 명세:**
- 📄 참조: User Flow > 6.1 프로필 수정
- 📄 참조: Database Design > 2.2 profiles

**인수 조건:**
- [ ] `app/(dashboard)/settings/profile/page.tsx` 구현
- [ ] 현재 프로필 정보 표시
- [ ] 이름 수정 기능
- [ ] 프로필 이미지 업로드 (Supabase Storage)
- [ ] 저장 성공/실패 토스트 메시지

**자가 수정 지침:**
이미지 업로드 시 파일 크기와 형식을 검사하세요 (최대 2MB, jpg/png만 허용).

---

### [x] M2-6: 비밀번호 찾기/재설정 페이지 구현

**컨텍스트 및 목표:**
비밀번호를 잊어버린 사용자가 이메일을 통해 비밀번호를 재설정할 수 있는 기능을 구현합니다.

**사용자 스토리:**
> 사용자로서, 비밀번호를 잊어버렸을 때 이메일로 재설정하고 싶습니다.

**기술 명세:**
- Supabase Auth `resetPasswordForEmail`
- 이메일 발송 → 링크 클릭 → 새 비밀번호 설정

**인수 조건:**
- [ ] `app/(auth)/forgot-password/page.tsx` 구현 (이메일 입력)
- [ ] 이메일 입력 후 "재설정 링크 발송" 버튼
- [ ] 발송 완료 안내 메시지
- [ ] `app/(auth)/reset-password/page.tsx` 구현 (새 비밀번호 설정)
- [ ] 새 비밀번호 + 확인 입력
- [ ] 재설정 성공 시 로그인 페이지로 이동
- [ ] 로그인 페이지에 "비밀번호 찾기" 링크 추가

**자가 수정 지침:**
재설정 링크는 일정 시간 후 만료됩니다. 만료된 링크로 접근 시 안내 메시지를 표시하세요.

---

### [x] M2-7: 비밀번호 변경 기능 구현

**컨텍스트 및 목표:**
로그인된 사용자가 설정 페이지에서 비밀번호를 변경할 수 있는 기능을 구현합니다.

**사용자 스토리:**
> 사용자로서, 보안을 위해 주기적으로 비밀번호를 변경하고 싶습니다.

**기술 명세:**
- 📄 참조: User Flow > 6.2 비밀번호 변경
- Supabase Auth `updateUser`

**인수 조건:**
- [ ] `app/(dashboard)/settings/password/page.tsx` 구현
- [ ] 현재 비밀번호 입력
- [ ] 새 비밀번호 + 확인 입력
- [ ] 비밀번호 규칙 검사 (최소 8자)
- [ ] 변경 성공 시 토스트 메시지
- [ ] 변경 실패 시 오류 메시지 (현재 비밀번호 틀림 등)

**자가 수정 지침:**
현재 비밀번호 검증은 Supabase에서 자동으로 처리됩니다. `updateUser` 호출 전 별도 검증이 필요하지 않습니다.

---

## M3: 핵심 기능 개발 (MVP - 통합 메일함)

### [x] M3-1: Mock 데이터 생성 및 로딩

**컨텍스트 및 목표:**
외부 API 연동 전 UI/UX를 검증하기 위한 Mock 데이터를 생성합니다.

**사용자 스토리:**
> 개발자로서, 실제 API 없이도 메일함 기능을 테스트하고 싶습니다.

**기술 명세:**
- 📄 참조: Database Design > 3. Mock 데이터 구조
- Gmail과 Slack 메시지 각각 10개 이상
- 다양한 상태 (읽음/안읽음, 별표, 라벨 등)

**인수 조건:**
- [ ] `mocks/messages.json` 생성 (20개 이상)
- [ ] `mocks/labels.json` 생성 (5개)
- [ ] Mock 데이터 로딩 훅 구현 (`hooks/useMockMessages.ts`)
- [ ] 실제 API와 동일한 인터페이스 유지

**자가 수정 지침:**
Mock 데이터의 타입이 실제 DB 스키마와 일치하는지 확인하세요.

---

### [x] M3-2: 메시지 목록 조회 기능 구현

**컨텍스트 및 목표:**
메시지 목록을 조회하고 필터링/정렬하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, Gmail과 Slack 메시지를 한 화면에서 보고 싶습니다.
> (PRD US-1.1)

**기술 명세:**
- 📄 참조: PRD > 5.1.1 메시지 목록
- 📄 참조: User Flow > 3.1 메시지 목록 조회
- TanStack Query 사용
- 필터: 서비스(gmail/slack/all), 뷰(inbox/sent/draft/spam/trash)

**인수 조건:**
- [ ] `hooks/useMessages.ts` 구현
- [ ] 서비스별 필터링 동작
- [ ] 뷰별 필터링 동작 (받은편지함, 보낸편지함 등)
- [ ] 최신순 정렬
- [ ] 페이지네이션 (20개 단위)
- [ ] 로딩/에러 상태 처리

**자가 수정 지침:**
필터 조합이 복잡해지면, 쿼리 파라미터를 URL에 반영하여 새로고침 시에도 유지되도록 하세요.

---

### [x] M3-3: 메시지 검색 기능 구현

**컨텍스트 및 목표:**
키워드로 메시지를 검색하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 메시지를 검색하고 싶습니다.
> (PRD US-1.3)

**기술 명세:**
- 📄 참조: PRD > 5.1.4 검색
- 📄 참조: User Flow > 3.1 (검색 분기)
- 제목, 본문, 발신자에서 검색

**인수 조건:**
- [ ] 검색 입력 필드 구현 (디바운싱 300ms)
- [ ] 검색 결과 하이라이트
- [ ] 검색 결과 없음 상태 UI
- [ ] 검색 초기화 버튼

**자가 수정 지침:**
검색어가 너무 짧으면 (2자 미만) 검색을 실행하지 마세요.

---

### [x] M3-4: 메시지 읽음/안읽음 토글 기능

**컨텍스트 및 목표:**
메시지를 읽음/안읽음 상태로 토글하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 메시지를 읽음/안읽음으로 표시하고 싶습니다.
> (PRD US-1.2)

**기술 명세:**
- 📄 참조: PRD > 5.1.3 메시지 작업
- 📄 참조: Database Design > messages.is_read
- 낙관적 업데이트 (Optimistic Update)

**인수 조건:**
- [ ] 개별 메시지 읽음/안읽음 토글
- [ ] 다중 선택 후 일괄 읽음/안읽음 처리
- [ ] UI에 즉시 반영 (낙관적 업데이트)
- [ ] 실패 시 롤백 및 에러 토스트

**자가 수정 지침:**
낙관적 업데이트 실패 시, 이전 상태로 정확히 롤백되는지 확인하세요.

---

### [x] M3-5: 라벨 관리 기능 구현

**컨텍스트 및 목표:**
라벨을 생성, 수정, 삭제하고 메시지에 적용하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 라벨을 붙여 메시지를 분류하고 싶습니다.
> (PRD US-1.4)

**기술 명세:**
- 📄 참조: PRD > 5.1.5 라벨 관리
- 📄 참조: User Flow > 3.4 라벨 관리
- 📄 참조: Database Design > 2.4 labels, 2.5 message_labels

**인수 조건:**
- [ ] 라벨 생성 모달 (이름, 색상)
- [ ] 라벨 수정/삭제 기능
- [ ] 메시지에 라벨 적용/제거
- [ ] 라벨별 메시지 필터링
- [ ] 사이드바에 라벨 목록 표시

**자가 수정 지침:**
라벨 삭제 시, 해당 라벨이 적용된 메시지들의 연결도 함께 삭제되도록 CASCADE를 확인하세요.

---

### [x] M3-6: 메시지 삭제 기능 구현

**컨텍스트 및 목표:**
메시지를 휴지통으로 이동하고, 휴지통에서 영구 삭제하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 불필요한 메시지를 삭제하고 싶습니다.

**기술 명세:**
- 📄 참조: PRD > 5.1.3 메시지 작업
- 📄 참조: User Flow > 3.2 (삭제 분기)
- Soft Delete (is_trash 플래그)

**인수 조건:**
- [ ] 메시지 삭제 시 휴지통으로 이동 (is_trash = true)
- [ ] 휴지통 뷰에서 메시지 목록 표시
- [ ] 휴지통에서 복원 기능
- [ ] 휴지통에서 영구 삭제 (확인 다이얼로그)
- [ ] 다중 선택 삭제

**자가 수정 지침:**
영구 삭제 전 반드시 확인 다이얼로그를 표시하세요. 실수로 삭제되면 복구할 수 없습니다.

---

### [x] M3-7: 메시지 작성 모달 구현

**컨텍스트 및 목표:**
새 메시지를 작성하는 모달을 구현합니다. Gmail과 Slack 중 선택하여 작성합니다.

**사용자 스토리:**
> 팀원으로서, 새 메일/메시지를 작성하고 싶습니다.
> (PRD US-1.6)

**기술 명세:**
- 📄 참조: User Flow > 3.3 메시지 작성
- 📄 참조: Design System > 6.6 모달
- 서비스 선택, 수신자, 제목(Gmail), 본문

**인수 조건:**
- [ ] `components/mail/ComposeModal.tsx` 구현
- [ ] 서비스 선택 (Gmail/Slack)
- [ ] 수신자 입력 (이메일/사용자명)
- [ ] 제목 입력 (Gmail만)
- [ ] 본문 작성 (텍스트에어리어)
- [ ] 임시저장 기능
- [ ] 전송 버튼 (Mock에서는 로컬 저장)
- [ ] 닫기 시 내용 있으면 저장 여부 확인

**자가 수정 지침:**
수신자 입력 시 자동완성을 고려하세요 (Phase 4에서 실제 연락처 연동 시).

---

### [x] M3-8: 메일함 페이지 통합 (오케스트레이터)

**컨텍스트 및 목표:**
지금까지 구현한 컴포넌트들을 통합하여 완전한 메일함 페이지를 완성합니다.

**사용자 스토리:**
> 팀원으로서, 메일함에서 모든 기능을 원활하게 사용하고 싶습니다.
> (PRD FEAT-1 전체)

**기술 명세:**
- 📄 참조: TRD > 7. 폴더 구조 > mail
- 📄 참조: User Flow > 3. FEAT-1 전체
- 상태 조합: activeView, serviceFilter, 검색, 선택, 모달

**인수 조건:**
- [ ] `app/(dashboard)/mail/page.tsx` 구현
- [ ] MailSidebar, MailList, MailDetail 통합
- [ ] 상태 간 연동 (필터 변경 → 목록 갱신)
- [ ] 반응형 레이아웃 (모바일에서 리스트/상세 토글)
- [ ] 키보드 단축키 (선택사항)
- [ ] 전체 Flow 테스트 통과

**자가 수정 지침:**
상태 관리가 복잡해지면, 커스텀 훅으로 분리하여 관심사를 분리하세요.

---

### [x] M3-9: 답장/전달 모달 구현 (ReplyModal, ForwardModal)

**컨텍스트 및 목표:**
메시지에 답장하거나 다른 사람에게 전달하는 모달을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 메시지에 답장하고 싶습니다.
> (PRD US-1.5)

**기술 명세:**
- 📄 참조: User Flow > 3.2 메시지 상세 조회 (답장/전달 분기)
- 📄 참조: PRD > 5.1.3 메시지 작업
- 원본 메시지 인용 포함
- 서비스별 답장 형식 (Gmail: 이메일 형식, Slack: 메시지 형식)

**인수 조건:**
- [ ] `components/mail/ReplyModal.tsx` 구현
- [ ] 원본 메시지 인용 표시 (> 형식 또는 인용 블록)
- [ ] 수신자 자동 채움 (원본 발신자)
- [ ] 제목 자동 채움 (Re: 원본 제목)
- [ ] `components/mail/ForwardModal.tsx` 구현
- [ ] 원본 메시지 내용 포함
- [ ] 새 수신자 입력
- [ ] 제목 자동 채움 (Fwd: 원본 제목)
- [ ] 전송 후 스레드에 추가 (답장의 경우)

**자가 수정 지침:**
답장과 전달은 유사한 구조이므로 공통 컴포넌트를 만들고 mode prop으로 구분하는 것도 고려하세요.

---

### [x] M3-10: 메시지 별표(Star) 기능 구현

**컨텍스트 및 목표:**
중요한 메시지에 별표를 표시하여 나중에 쉽게 찾을 수 있게 합니다.

**사용자 스토리:**
> 팀원으로서, 중요한 메시지에 별표를 붙여 나중에 쉽게 찾고 싶습니다.

**기술 명세:**
- 📄 참조: Database Design > messages.is_starred
- 📄 참조: Design System > 6.8 메시지 리스트 아이템 (별표 아이콘)
- 낙관적 업데이트 적용

**인수 조건:**
- [ ] 메시지 리스트에서 별표 아이콘 클릭으로 토글
- [ ] 별표된 메시지 시각적 구분 (채워진 별 아이콘)
- [ ] 별표 메시지만 필터링하는 뷰 (사이드바에 "별표 표시" 메뉴)
- [ ] 낙관적 업데이트로 즉시 UI 반영
- [ ] 다중 선택 후 일괄 별표/해제 (선택사항)

**자가 수정 지침:**
별표 토글은 읽음/안읽음 토글과 유사한 패턴입니다. M3-4의 구현을 참고하세요.

---

## M4: 근태 및 캘린더 기능 (Phase 2)

### [x] M4-1: 출퇴근 기록 페이지 구현

**컨텍스트 및 목표:**
출근/퇴근 버튼을 클릭하여 근태를 기록하는 페이지를 구현합니다.

**사용자 스토리:**
> 팀원으로서, 클릭 한 번으로 출근을 기록하고 싶습니다.
> (PRD US-2.1, US-2.2)

**기술 명세:**
- 📄 참조: PRD > 5.2 Phase 2 > FEAT-2
- 📄 참조: User Flow > 4.1 출근 기록, 4.2 퇴근 기록
- 📄 참조: Database Design > 2.6 attendances

**인수 조건:**
- [ ] `app/(dashboard)/attendance/page.tsx` 구현
- [ ] 현재 날짜/시간 표시
- [ ] 출근 버튼 (출근 전 상태)
- [ ] 퇴근 버튼 (출근 후 상태)
- [ ] 오늘 근무 시간 표시 (퇴근 후)
- [ ] 중복 출근/퇴근 방지

**자가 수정 지침:**
시간대(timezone) 처리에 주의하세요. 서버와 클라이언트의 시간대가 다를 수 있습니다.

---

### [x] M4-2: 근태 현황 조회 기능 구현

**컨텍스트 및 목표:**
이번 주/이번 달 근태 현황을 조회하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 이번 달 내 근태 현황을 보고 싶습니다.
> (PRD US-2.3)

**기술 명세:**
- 📄 참조: User Flow > 4.3 근태 현황 조회
- 📄 참조: Database Design > 2.6 attendances

**인수 조건:**
- [ ] `app/(dashboard)/attendance/report/page.tsx` 구현
- [ ] 기간 선택 (이번 주/이번 달/커스텀)
- [ ] 캘린더 형태로 출근 일자 표시
- [ ] 총 근무일, 총 근무시간 통계
- [ ] 날짜 클릭 시 상세 정보 표시

**자가 수정 지침:**
데이터가 많을 때 성능 문제가 발생하면, 기간별로 데이터를 분할 조회하세요.

---

### [x] M4-3: 팀 캘린더 페이지 구현

**컨텍스트 및 목표:**
팀 일정을 조회하고 관리하는 캘린더 페이지를 구현합니다.

**사용자 스토리:**
> 팀원으로서, 오늘/이번 주 일정을 한눈에 보고 싶습니다.
> (PRD US-3.1)

**기술 명세:**
- 📄 참조: PRD > 5.2 Phase 2 > FEAT-3
- 📄 참조: User Flow > 5.1 일정 조회
- 📄 참조: Database Design > 2.7 events

**인수 조건:**
- [ ] `app/(dashboard)/calendar/page.tsx` 구현
- [ ] 월간/주간/일간 뷰 전환
- [ ] 일정 목록 표시
- [ ] 일정 클릭 시 상세 모달
- [ ] 이전/다음 기간 이동

**자가 수정 지침:**
캘린더 라이브러리 (`react-big-calendar` 또는 직접 구현)를 선택하고, 일관된 스타일을 적용하세요.

---

### [x] M4-4: 일정 생성/수정 기능 구현

**컨텍스트 및 목표:**
새 일정을 생성하고 수정하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 새 일정을 등록하고 싶습니다.
> (PRD US-3.2)

**기술 명세:**
- 📄 참조: User Flow > 5.2 일정 생성
- 📄 참조: Database Design > 2.7 events

**인수 조건:**
- [ ] 일정 생성 모달 구현
- [ ] 제목, 설명, 시작/종료 시간, 종일 여부
- [ ] 색상 선택
- [ ] 일정 수정 기능
- [ ] 일정 삭제 기능

**자가 수정 지침:**
종료 시간이 시작 시간보다 빠르면 유효성 검사에서 거부하세요.

---

### [x] M4-5: 일정 참석자 관리 기능

**컨텍스트 및 목표:**
일정에 참석자를 추가하고 관리하는 기능을 구현합니다.

**사용자 스토리:**
> 팀원으로서, 일정에 참석자를 초대하고 싶습니다.
> (PRD US-3.4)

**기술 명세:**
- 📄 참조: Database Design > 2.8 event_participants

**인수 조건:**
- [ ] 일정 생성/수정 시 참석자 선택
- [ ] 참석자 목록 표시
- [ ] 참석 상태 표시 (대기/수락/거절)
- [ ] 본인 참석 상태 변경 가능

**자가 수정 지침:**
참석자 선택 시, 팀 멤버 목록에서 선택할 수 있도록 자동완성을 구현하세요.

---

### [x] M4-6: 대시보드 페이지 구현

**컨텍스트 및 목표:**
메인 대시보드에서 오늘의 할 일, 최근 메시지, 근태 현황을 한눈에 보여줍니다.

**사용자 스토리:**
> 사용자로서, 로그인하면 오늘 해야 할 일들을 바로 확인하고 싶습니다.

**기술 명세:**
- 📄 참조: PRD > 4.1 공통/인증 > 홈 대시보드
- 오늘 일정, 미읽은 메시지, 오늘 근태 상태 위젯

**인수 조건:**
- [ ] `app/(dashboard)/page.tsx` 구현
- [ ] 오늘 일정 위젯 (최대 5개)
- [ ] 미읽은 메시지 카운트 및 미리보기
- [ ] 오늘 근태 상태 (출근 전/근무 중/퇴근)
- [ ] 각 위젯에서 상세 페이지로 이동 링크

**자가 수정 지침:**
위젯 데이터 로딩 시 병렬로 요청하여 로딩 시간을 단축하세요.

---

### [x] M4-7: 팀장용 팀원 근태 현황 조회

**컨텍스트 및 목표:**
팀장이 팀원들의 오늘 출근 현황과 월간 근태 리포트를 조회할 수 있는 기능을 구현합니다.

**사용자 스토리:**
> 팀장으로서, 팀원들의 오늘 출근 현황을 보고 싶습니다.
> (PRD US-2.4)
> 팀장으로서, 팀원들의 월간 근태 리포트를 보고 싶습니다.
> (PRD US-2.5)

**기술 명세:**
- 📄 참조: PRD > 3.2 보조 페르소나 (팀장 현수)
- 📄 참조: Database Design > 2.6 attendances
- 📄 참조: TRD > 5. 접근 제어 > manager 역할
- 팀원 목록 조회 권한 필요

**인수 조건:**
- [ ] `app/(dashboard)/attendance/team/page.tsx` 구현
- [ ] 오늘 팀원 출근 현황 리스트 (출근/미출근/휴가)
- [ ] 팀원별 출퇴근 시간 표시
- [ ] 월간 팀 근태 리포트 (선택 시)
- [ ] 팀원별 근무일수, 총 근무시간 통계
- [ ] manager 역할만 접근 가능 (권한 체크)
- [ ] 권한 없을 시 접근 거부 메시지

**자가 수정 지침:**
MVP에서는 단일 팀 가정이므로, 모든 사용자를 팀원으로 조회해도 됩니다. 추후 팀 구조가 추가되면 RLS를 강화하세요.

---

## M5: 테스트 및 배포

### [x] M5-1: 단위 테스트 작성

**컨텍스트 및 목표:**
핵심 로직과 컴포넌트에 대한 단위 테스트를 작성합니다.

**기술 명세:**
- Jest + React Testing Library
- 주요 훅, 유틸 함수, 컴포넌트 테스트

**인수 조건:**
- [ ] 테스트 환경 설정 (Jest, RTL)
- [ ] `useMessages` 훅 테스트
- [ ] `useAttendance` 훅 테스트
- [ ] 주요 컴포넌트 렌더링 테스트
- [ ] 테스트 커버리지 60% 이상

**자가 수정 지침:**
Mock 데이터와 실제 API 응답 형식이 일치하는지 확인하세요.

---

### [x] M5-2: E2E 테스트 작성

**컨텍스트 및 목표:**
핵심 사용자 플로우에 대한 E2E 테스트를 작성합니다.

**기술 명세:**
- Playwright
- 📄 참조: User Flow 문서 전체

**인수 조건:**
- [ ] Playwright 설정
- [ ] 로그인 플로우 테스트
- [ ] 메일함 조회/검색 테스트
- [ ] 출퇴근 기록 테스트
- [ ] CI에서 자동 실행

**자가 수정 지침:**
Flaky 테스트(간헐적 실패)가 발생하면 적절한 대기(wait) 로직을 추가하세요.

---

### [x] M5-3: Vercel 배포 설정

**컨텍스트 및 목표:**
Vercel에 프로젝트를 배포하고 자동 배포 파이프라인을 구성합니다.

**기술 명세:**
- 📄 참조: TRD > 2.3 배포/호스팅
- Git 연동 자동 배포

**인수 조건:**
- [ ] Vercel 프로젝트 생성 및 연결
- [ ] 환경 변수 설정 (Supabase 키 등)
- [ ] main 브랜치 push 시 자동 배포
- [ ] Preview 배포 (PR 생성 시)
- [ ] 커스텀 도메인 연결 (선택사항)

**자가 수정 지침:**
빌드 실패 시, 빌드 로그를 확인하고 의존성 또는 환경 변수 문제를 해결하세요.

---

### [x] M5-4: 운영 모니터링 설정

**컨텍스트 및 목표:**
배포 후 서비스 상태를 모니터링할 수 있는 기본 설정을 합니다.

**기술 명세:**
- Vercel Analytics (기본 제공)
- 에러 트래킹 (Sentry 권장)

**인수 조건:**
- [ ] Vercel Analytics 활성화
- [ ] Sentry 연동 (선택사항)
- [ ] 주요 에러 알림 설정
- [ ] 성능 지표 확인 (LCP, FID, CLS)

**자가 수정 지침:**
민감한 정보가 에러 리포트에 포함되지 않도록 필터링을 설정하세요.

---

## 부록: 태스크 진행 체크리스트

### MVP 완료 기준
- [x] M0 완료: 프로젝트 초기화 (6개 태스크)
- [x] M1 완료: UI 컴포넌트 (7개 태스크)
- [x] M2 완료: 인증 (7개 태스크)
- [x] M3 완료: 통합 메일함 (10개 태스크)
- [x] M5-3 완료: 배포

### Phase 2 완료 기준
- [x] M4 완료: 근태 + 캘린더 (7개 태스크)
- [x] M5 완료: 테스트 + 모니터링 (4개 태스크)

### 전체 태스크 요약 (총 41개)

| 마일스톤 | 태스크 ID | 핵심 내용 |
|----------|-----------|----------|
| M0 | M0-1 ~ M0-6 | 프로젝트 설정, Supabase, 상태관리, DB 스키마 |
| M1 | M1-1 ~ M1-7 | shadcn, 디자인토큰, 레이아웃, 메일 UI 컴포넌트 |
| M2 | M2-1 ~ M2-7 | 로그인, 회원가입, 인증, 비밀번호 관리 |
| M3 | M3-1 ~ M3-10 | Mock 데이터, 메시지 CRUD, 검색, 라벨, 답장/전달 |
| M4 | M4-1 ~ M4-7 | 출퇴근, 근태현황, 캘린더, 팀장 기능 |
| M5 | M5-1 ~ M5-4 | 단위테스트, E2E, 배포, 모니터링 |

### 문서 참조 가이드

| 문서 | 참조 용도 |
|------|----------|
| PRD | 사용자 스토리, 기능 요구사항 |
| TRD | 기술 스택, 아키텍처, 보안 |
| User Flow | 화면 흐름, 상태 전이 |
| Database Design | 테이블 구조, 타입 정의 |
| Design System | UI 스타일, 컴포넌트 명세 |
| Coding Convention | 코드 규칙, AI 협업 가이드 |
